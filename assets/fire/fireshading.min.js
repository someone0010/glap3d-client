!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.particleFire=e()}(this,function(){"use strict";function t(t){return A[t]}function e(){var e=t("THREE"),A=function(A){var o={color:{type:"c",value:null},size:{type:"f",value:0},texture:{type:"t",value:function(){if(n)return n;var e=t("THREE"),r=new Image;return n=new e.Texture,n.wrapS=n.wrapT=e.RepeatWrapping,n.image=r,r.onload=function(){n.needsUpdate=!0},r.src="/assets/fire/shaderfire.png",n}()},time:{type:"f",value:0},heightOfNearPlane:{type:"f",value:0}};e.ShaderMaterial.call(this,{uniforms:o,vertexShader:["attribute float randam;","attribute float sprite;","uniform float time;","uniform float size;","uniform float heightOfNearPlane;","varying float vSprite;","varying float vOpacity;","float PI = 3.14;","float quadraticIn( float t ) {","float tt = t * t;","return tt * tt;","}","void main() {","float progress = fract( time + ( 2.0 * randam - 1.0 ) );","float progressNeg = 1.0 - progress;","float ease = quadraticIn( progress );","float influence = sin( PI * ease );","vec3 newPosition = position * vec3( 1.0, ease, 1.0 );","gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );","gl_PointSize = ( heightOfNearPlane * size ) / gl_Position.w;","vOpacity = min( influence * 4.0, 1.0 ) * progressNeg;","vSprite = sprite;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D texture;","varying float vSprite;","varying float vOpacity;","void main() {","vec2 texCoord = vec2(","gl_PointCoord.x * "+r+" + vSprite,","gl_PointCoord.y",");","gl_FragColor = vec4( texture2D( texture, vec2( texCoord ) ).xyz * color * vOpacity, 1.0 );","}"].join("\n"),blending:e.AdditiveBlending,depthTest:!0,depthWrite:!1,transparent:!0}),this.color=new e.Color(16720384),this.size=.4,this.setValues(A),this.uniforms.color.value=this.color,this.uniforms.size.value=this.size};return A.prototype=Object.create(e.ShaderMaterial.prototype),A.prototype.update=function(t){this.uniforms.time.value=(this.uniforms.time.value+t)%1},A.prototype.setPerspective=function(t,r){this.uniforms.heightOfNearPlane.value=Math.abs(r/(2*Math.tan(e.Math.degToRad(.5*t))))},A}var r=.25,A={},o={},n=void 0,i={install:function(t){A.THREE=t.THREE;for(var e=0,r=o.THREE.length;e<r;e++)o.THREE[e]();delete o.THREE}};return function(t,e){o[t]||(o[t]=[]),o[t].push(e)}("THREE",function(){i.Geometry=function(){var e=t("THREE"),A=function(t,A,o){e.BufferGeometry.call(this);for(var n=.5*A,i=new Float32Array(3*o),a=new Float32Array(o),f=new Float32Array(o),u=0;u<o;u++){var s=Math.sqrt(Math.random())*t,c=2*Math.random()*Math.PI;i[3*u+0]=Math.cos(c)*s,i[3*u+1]=(t-s)/t*n+n,i[3*u+2]=Math.sin(c)*s,f[u]=r*(4*Math.random()|0),a[u]=Math.random(),0===u&&(i[3*u+0]=0,i[3*u+1]=0,i[3*u+2]=0)}this.addAttribute("position",new e.BufferAttribute(i,3)),this.addAttribute("randam",new e.BufferAttribute(a,1)),this.addAttribute("sprite",new e.BufferAttribute(f,1))};return A.prototype=Object.create(e.BufferGeometry.prototype),A}(),i.Material=e()}),i});
